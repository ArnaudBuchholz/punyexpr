(()=>{let u="literal",K="identifier",L="regex",M="symbol",Q="function",V="context";class X extends Error{constructor(e,r,t){super(r),this.name=e,this.offset=t}}X.throw=(e,r,t)=>{throw new X(e,r,t)};let n=(()=>{let t="abstract,arguments,await,boolean,break,byte,case,catch,char,class,const,continue,debugger,default,delete,do,double,else,enum,eval,export,extends,final,finally,float,for,function,goto,if,implements,import,in,instanceof,int,interface,let,long,native,new,package,private,protected,public,return,short,static,super,switch,synchronized,this,throw,throws,transient,try,var,void,volatile,while,with,yield".split(",");let r=new RegExp([/'((?:[^'\\]|\\.)*)'/,/"((?:[^"\\]|\\.)*)"/,/((?:\d+(?:\.\d*)?|\.\d+))/,/([a-zA-Z_][a-zA-Z_0-9]*)/,/(\/(?:[^/\\]|\\.)+\/[gmiysd]*)/,/(\+|-|\*|\/|\[|\]|\.|\?|:|%|<|=|>|!|&|\||\(|\)|,)/,/(\s)/,/(.)/].map(e=>{e=e.toString();return e.substring(1,e.length-1)}).join("|"),"g"),i=e=>X.throw("InvalidTokenError","Invalid token @"+e,e),n={false:!1,null:null,true:!0,undefined:void 0,Infinity:1/0,NaN:NaN},s=[e=>[u,e.replace(/\\'/g,"'")],e=>[u,e.replace(/\\"/g,'"')],e=>[u,parseFloat(e)],(e,r)=>Object.prototype.hasOwnProperty.call(n,e)?[u,n[e]]:(t.includes(e)&&i(r),[K,e]),e=>{var r=e.lastIndexOf("/"),t=e.substring(1,r),e=e.substring(r+1);return[L,[t,e]]},e=>[M,e],e=>[],(e,r)=>i(r)];return e=>{let n=[],a=0,l,o=[u,K];return e.replace(r,({length:e},...r)=>{var t=r.findIndex(e=>void 0!==e),r=r[t],[t,r]=(0,s[t])(r,a);o.includes(t)&&o.includes(l)&&i(a),void 0!==(l=t)&&n.push([t,r,a,e]),a+=e}),n}})(),Y=Symbol("punyexpr"),a=(()=>{var e=(t,n)=>(e,...r)=>Object.assign(n.bind(null,...r),{[Y]:[t,r,e]});let l=e("constant",e=>e),n=e("array",(...e)=>{let r=e[e.length-1];return e.slice(0,-1).map(e=>e(r))}),a=e("regex",(e,r,t)=>t(e,r)),o=(e,r)=>new RegExp(e,r),i=e(V,(e,r)=>r[e(r)]),s=e("property",(e,r,t)=>{e=e(t),r=e[r(t)];return typeof r===Q?r.bind(e):r}),u=e("call",(e,r,t)=>e(t).apply(null,r.map(e=>e(t))));var r=e("pos",(e,r)=>+e(r)),t=e("neg",(e,r)=>-e(r)),p=e("not",(e,r)=>!e(r)),d=e("getTypeof",(e,r)=>typeof e(r)),c=e("exp",(e,r,t)=>e(t)**r(t)),g=e("mul",(e,r,t)=>e(t)*r(t)),f=e("div",(e,r,t)=>e(t)/r(t)),v=e("remainder",(e,r,t)=>e(t)%r(t)),h=e("add",(e,r,t)=>e(t)+r(t)),y=e("sub",(e,r,t)=>e(t)-r(t)),x=e("lt",(e,r,t)=>e(t)<r(t)),b=e("gt",(e,r,t)=>e(t)>r(t)),w=e("lte",(e,r,t)=>e(t)<=r(t)),m=e("gte",(e,r,t)=>e(t)>=r(t)),E=e("eq",(e,r,t)=>e(t)==r(t)),P=e("neq",(e,r,t)=>e(t)!=r(t)),Z=e("eqq",(e,r,t)=>e(t)===r(t)),_=e("neqq",(e,r,t)=>e(t)!==r(t)),C=e("and",(e,r,t)=>e(t)&&r(t)),D=e("or",(e,r,t)=>e(t)||r(t));let F=e("ternary",(e,r,t,n)=>(e(n)?r:t)(n)),k,O,j=()=>{0===k.length&&X.throw("EndOfExpressionError","Unexpected end of expression")},N=()=>(j(),k[0]),q=()=>N()[2],S=(e,r)=>{let t;var[r,n]=t=r?r[Y][2]:N().splice(2);return[e,r+n-e]},I=(e=1)=>k.splice(0,e),R=(e=void 0)=>{var r,t;return 0!==k.length&&([r,t]=k[0],r===M)&&(!e||e.includes(t))},U=e=>{var r,t=[];for(r of k){var[n,a]=r;if(n!==M)break;t.push(a)}let l=t.join("");e=e.filter(e=>l.startsWith(e)).sort((e,r)=>r.length-e.length)[0];return!!e&&(I(e.length),e)},z=()=>X.throw("UnexpectedTokenError","Unexpected token @"+q(k),q(k)),W=()=>{for(var e=q(),r=(I(),[]);!R("]");){var t=J();r.push(t),R(",")&&I()}e=S(e);return I(),n(e,...r)},B=()=>{if(j(),R("("))return I(),r=J(),R(")")||z(),I(),r;if(R("["))return W();R()&&z();var[[r,t,...n]]=I();if(r===K)return i(n,l(n,t));if(r!==L)return l(n,t);{O.regex||([r]=n,X.throw("RegExpDisabledError","Regular expressions are disabled @"+r,r));var[r,t]=t;let e=O.regex;return typeof e!==Q&&(e=o),a(n,r,t,e)}},G={"+":r,"-":t,"!":p,typeof:d},A=()=>{var[e,r,t]=N();return R("+-!")||e===K&&"typeof"===r?(e=S(t),I(),(0,G[r])(e,A())):(()=>{let n=q(),a=B();for(var e={"(":()=>{for(var e=[];!R(")");)0<e.length&&(R(",")||z(),I()),e.push(J());var r=S(n);I(),a=u(r,a,e)},"[":()=>{var e=J(),r=(R("]")||z(),S(n));I(),a=s(r,a,e)},".":()=>{var[e,r,...t]=N(),e=(e!==K&&z(),S(n));I(),a=s(e,a,l(t,r))}};R("([.");){var[[,r]]=I();e[r]()}return a})()};e=(l,o)=>{let i=Object.keys(o);return()=>{var e=q();let r=l(),t=U(i);for(;t;){var n=l(),a=S(e,n);r=o[t](a,r,n),t=U(i)}return r}};let H=e(e(e(e(e(e(e(A,{"**":c}),{"*":g,"/":f,"%":v}),{"+":h,"-":y}),{"<":x,">":b,"<=":w,">=":m}),{"==":E,"!=":P,"===":Z,"!==":_}),{"&&":C}),{"||":D}),T=()=>{var e,r,t=q(),n=H();return U(["?"])?(e=T(),j(),R(":")||z(),I(),r=T(),t=S(t,r),F(t,n,e,r)):n},J=T;return(...e)=>{[k,O]=e;e=J();return 0!==k.length&&X.throw("UnexpectedRemainderError","Unexpected left over tokens @"+q(),q()),e}})(),l=e=>({value:e,writable:!1}),o=(e,t)=>{Object.defineProperties(e,Object.keys(t).reduce((e,r)=>(e[r]=l(t[r]),e),{}))},i=e=>{var[e,r,[t,n]]=e[Y];let a={};return{op:e,at:t,length:n,args:r.map(e=>typeof e===Q?e[Y]?i(e):a:Array.isArray(e)?e.map(i):e).filter(e=>e!==a)}};var e=(e,r={})=>{let t=a(n(e),{regex:!1,...r});r=(e={})=>t(e);return o(r,{toJSON:i.bind(null,t),toString:()=>e,listContextualNames:(e=>{let t=new Set;return JSON.stringify(i(e),(e,r)=>(r.op===V&&t.add(r.args[0].args[0]),r)),[...t.values()]}).bind(null,t)}),r};o(e,{tokenize:n,Error:X,version:"1.2.0"}),module.exports={punyexpr:e}})();